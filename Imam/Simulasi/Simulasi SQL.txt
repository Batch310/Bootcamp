-- Soal 1
select
 e.status as "Status Karyawan",
 count(status) as "Jumlah Karyawan"
from biodata b
inner join employee e
	on b.id=e.biodata_id
group by e.status;

-- Soal 2
select 
  b.*
from biodata b
left join employee e
	on b.id=e.biodata_id
where e.status is null;

-- Soal 3
select
	b.first_name||' '||b.last_name as "Full Name",
	case
		when b.marital_status is true then 'Sudah Menikah'
		else 'Belum Menikah'
	end as "Status Pernikahan",
	f.status
from biodata b
left join family f
	on b.id=f.biodata_id;
	
-- Soal 4
select
 name
from department;

-- Soal 5
select
	date_part('year',to_date(dob,'yyyy-mm-dd')) as "Tahun Lahir",
	count(date_part('year',to_date(dob,'yyyy-mm-dd'))) as "Jumlah Karyawan"
from biodata b
inner join employee e
	on b.id=e.biodata_id
group by "Tahun Lahir";

-- Soal 6
select
   b.*,
   p.name as "Jabatan"
from biodata b
inner join employee e
	on b.id=e.biodata_id
inner join employee_position ep
	on e.id=ep.employee_id
inner join position p
	on ep.position_id=p.id;
	
-- Soal 7
select
	b.*
from biodata b
where pob ilike 'jakarta' and 
  address not ilike '%Jakarta';

-- Soal 8
select
	b.first_name||' '||b.last_name as "Full Name",
	p.name as "Jabatan",
	 date_part('year',to_date(dob,'yyyy-mm-dd'))
from biodata b
inner join employee e
	on b.id=e.biodata_id
inner join employee_position ep
	on ep.employee_id=e.id
inner join position p
	on p.id=ep.position_id

-- Soal 9
select
	b.first_name as "Nama Karyawan",
	sum(age(end_date,start_date)) as "Jumlah Cuti"
from biodata b
inner join employee e
	on b.id=e.biodata_id
inner join leave_request ls
	on e.id=ls.employee_id
group by "Nama Karyawan";

-- Soal 10
select
	b.first_name as "Nama Karyawan",
	tt.name as "Jenis Perjalanan",
	tr.start_date as "Tanggal Perjalanan",
	ts.item_cost as "Total Pengeluaran"
from biodata b
inner join employee e
	on b.id=e.biodata_id
inner join travel_request tr
	on e.id=tr.employee_id
inner join travel_type tt
	on tr.travel_type_id=tt.id
inner join travel_settlement ts
	on tr.id=ts.travel_request_id
group by First_name,"Jenis Perjalanan","Tanggal Perjalanan","Total Pengeluaran"




