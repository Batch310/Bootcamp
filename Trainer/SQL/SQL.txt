--DDL Buat Database
cReAtE database batch310;

--DDL Hapus Database
drop database batch310;

--DDL Bikin Tabel
create table pegawai(
	id_pegawai serial primary key,
	umur integer,
	nama_pegawai text
);

--DDL Hapus Tabel
drop table pegawai;

--Buatlah table KTP dengan kolom
--nik int pk
--nama text
--ttl text
--jenis_kelamin text
--alamat text
create table ktp(
	nik integer primary key,
	nama text,
	ttl text,
	jenis_kelamin text,
	alamat text
);

--DML, tampilkan semua kolom dari tabel ktp
select * from ktp;

--DDL, rename kolom tabel
Alter table ktp
rename column ttl to tempat_tgl_lahir;

--DDL, ubah tipe data kolom
alter table ktp
alter column jenis_kelamin type boolean using jenis_kelamin::boolean;

--DDL, delete kolom
alter table ktp
drop column tempat_tgl_lahir;

--DDL, add kolom
alter table ktp
add column tempat_lahir text,
add column tgl_lahir date;


select * from pegawai;
--DML, Insert Data

--Cara 1
insert into pegawai(umur,nama_pegawai)
values
(20,'Tian Swaseneger'),
(25,'Panji si manusia ular');

--Cara 2
insert into pegawai
values
(9,22,'Yudha the Resinging');

select * from pegawai;
--DML Update Data
update pegawai
set umur = 15
where id_pegawai = 3;

update pegawai
set umur = 25, nama_pegawai = 'Pesulap Merah'
where id_pegawai = 3;

select * from pegawai;
--DML Delete data
delete from pegawai
where id_pegawai = 4;

--DML Select Select
select * from pegawai;
--Select data dari kolom pilihan
select nama_pegawai from pegawai;
select umur,nama_pegawai from pegawai;

--Alias nama kolom
select
	nama_pegawai as "Nama Pegawai",
	umur
from 
	pegawai;

--Coba coba postgre
select 23*4 as "Hasil Perkalina 23x4";
select 'Panji' as "Pak Ketua";

--select order by
select * from pegawai;
select * from pegawai order by id_pegawai ASC;
select * from pegawai order by id_pegawai DESC;

--select distinct
select * from pegawai;
select distinct umur,nama_pegawai from pegawai;
select distinct umur from pegawai;

--select where biasa
select * from pegawai;
select * from pegawai where nama_pegawai = 'Panji si manusia ular';
select * from pegawai where umur = 20 AND id_pegawai = 1;
select distinct nama_pegawai from pegawai where umur =25;
select distinct umur,nama_pegawai
from pegawai where nama_pegawai = 'Panji si manusia ular';

--select where in
select * from pegawai where umur in (23,25,20);
select * from pegawai where nama_pegawai
in ('Panji si manusia ular','Pesulap Merah')

--select where between / diantara
select * from pegawai where umur between 20 and 22;

--select where like / seperti / mengandung
select * from pegawai where nama_pegawai like 'Panji%';
select * from pegawai where nama_pegawai like '%ular';
select * from pegawai where nama_pegawai like '%an%';

--Fungsi Agregat
-- AVG => Average menghitung rata-rata
-- SUM => menghitung penjumlahan
-- Count => Menghitung
-- Min => Nilai terendah
-- Max => Nilai tertinggi
select max(umur) from pegawai;
select min(umur) from pegawai;

--group by
select nama_pegawai,sum(umur) from pegawai group by nama_pegawai;

--Latihan Film
create table film(
    kd_film text primary key,
    nm_film text,
    pendapatan integer,
    nominasi integer
);

insert into film values
('F001','IRON MAN',2000000000,3),
('F002','IRON MAN 2',1800000000,2),
('F003','IRON MAN 3',1200000000,0),
('F004','AVENGER:CIVIL WAR',2000000000,1),
('F005','SPIDERMAN HOME COMING',1300000000,0),
('F006','THE RAID',800000000,5),
('F007','FAST & FURIOUS',830000000,2),
('F008','HABIBI DAN AINUN',670000000,4),
('F009','POLICE STORY',700000000,3),
('F010','POLICE STORY 2',710000000,1),
('F011','POLICE STORY 3',615000000,0),
('F012','RUSH HOUR',695000000,2),
('F013','KUNGFU PANDA',923000000,5);

