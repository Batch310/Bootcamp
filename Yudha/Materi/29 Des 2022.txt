--komentar
--DDL Buat database

CREATE DATABASE batch310;

--DDL Hapus database

DROP DATABASE batch310;

--DDL Buat Tabel

CREATE TABLE PEGAWAI(
	ID_PEGAWAI INTEGER PRIMARY KEY,
	UMUR_PEGAWAI INTEGER,
	NAMA_PEGAWAI TEXT
);

--DDL Hapus Table
DROP TABLE PEGAWAI;

CREATE TABLE KTP(
	NIK INTEGER PRIMARY KEY,
	NAMA TEXT,
	TTL TEXT,
	JENIS_KELAMIN TEXT,
	ALAMAT TEXT
);

--DML SELECT
SELECT * FROM KTP;

--DDL ALTER TABLE
ALTER TABLE KTP
	RENAME COLUMN TTL TO TEMPAT_TANGGAL_LAHIR;
	
ALTER TABLE KTP
	ALTER COLUMN JENIS_KELAMIN TYPE BOOLEAN
	USING JENIS_KELAMIN::BOOLEAN;
	
--DDL DELETE COLUMN
ALTER TABLE KTP
	DROP COLUMN TEMPAT_TANGGAL_LAHIR;
	
--DDL ADD COLUMN
ALTER TABLE KTP
	ADD COLUMN TEMPAT_LAHIR TEXT,
	ADD COLUMN TANGGAL_LAHIR DATE;

SELECT * FROM PEGAWAI;
--DML INSERT DATA
--CARA 1
INSERT INTO PEGAWAI(ID_PEGAWAI,UMUR_PEGAWAI,NAMA_PEGAWAI)
	VALUES
	(10,20,'YYKW'),
	(20,21,'Yudha');
	
-- CARA 2
INSERT INTO PEGAWAI
	VALUES
	(5,22,'Yuniartha'),
	(6,23,'Kusuma');

--DML UPDATE DATA
UPDATE PEGAWAI
	SET UMUR_PEGAWAI = 17
	WHERE ID_PEGAWAI = 1;
	
UPDATE PEGAWAI
	SET UMUR_PEGAWAI = 18, NAMA_PEGAWAI = 'Wardhana'
	WHERE ID_PEGAWAI = 1;
	
--DML DELETE DATA
DELETE FROM PEGAWAI
	WHERE ID_PEGAWAI = 2;
	
--DML SELECT
SELECT * FROM PEGAWAI;

SELECT NAMA_PEGAWAI FROM PEGAWAI;

SELECT NAMA_PEGAWAI, UMUR_PEGAWAI FROM PEGAWAI;

-- ALIAS NAMA KOLOM
SELECT 
	NAMA_PEGAWAI AS "Nama Pegawai",
	UMUR_PEGAWAI AS UMUR
FROM PEGAWAI;

-- NYOBA
SELECT 23*4 AS "Hasil Perkalian 23 x 4";
SELECT 'P-MAN' AS "HERO";

-- SELECT ORDER BY
SELECT * FROM PEGAWAI ORDER BY ID_PEGAWAI ASC;
SELECT * FROM PEGAWAI ORDER BY ID_PEGAWAI DESC;

--SELECT DISTICT
SELECT DISTINCT NAMA_PEGAWAI FROM PEGAWAI

--SELCET WHERE
SELECT * FROM PEGAWAI;
SELECT * FROM PEGAWAI WHERE NAMA_PEGAWAI = 'Kusuma';
SELECT DISTINCT * FROM PEGAWAI WHERE NAMA_PEGAWAI = 'Yuniartha';
SELECT DISTINCT UMUR_PEGAWAI,NAMA_PEGAWAI FROM PEGAWAI WHERE NAMA_PEGAWAI = 'Yuniartha';
SELECT * FROM PEGAWAI WHERE UMUR_PEGAWAI = 22;

--SELECT WHERE IN
SELECT * FROM PEGAWAI WHERE UMUR_PEGAWAI IN (18,23);
SELECT * FROM PEGAWAI WHERE NAMA_PEGAWAI IN ('Kusuma', 'Wardhana');

--SELECT BETWEEN
SELECT * FROM PEGAWAI WHERE UMUR_PEGAWAI BETWEEN 22 AND 23;

--SELECT WHERE LIKE / SEPERTI / MENGANDUNG
SELECT * FROM PEGAWAI WHERE NAMA_PEGAWAI LIKE 'Y%';
SELECT * FROM PEGAWAI WHERE NAMA_PEGAWAI LIKE '%a';
SELECT * FROM PEGAWAI WHERE NAMA_PEGAWAI LIKE '%n%';

--FUNGSI AGREGATE
SELECT SUM(UMUR_PEGAWAI) FROM PEGAWAI;
SELECT MIN(UMUR_PEGAWAI) FROM PEGAWAI;
SELECT MAX(UMUR_PEGAWAI) FROM PEGAWAI;
SELECT COUNT(UMUR_PEGAWAI) FROM PEGAWAI;
SELECT AVG(UMUR_PEGAWAI) FROM PEGAWAI;

--GROUP BY
SELECT NAMA_PEGAWAI, COUNT(UMUR_PEGAWAI) FROM PEGAWAI GROUP BY NAMA_PEGAWAI;
SELECT NAMA_PEGAWAI, SUM(UMUR_PEGAWAI) FROM PEGAWAI GROUP BY NAMA_PEGAWAI;