select * from biodata

--SOAL 1
SELECT 
	E.STATUS,
	COUNT(E.STATUS) AS JUMLAH
FROM BIODATA B
INNER JOIN EMPLOYEE E ON B.ID = E.BIODATA_ID
GROUP BY E.STATUS

--SOAL 2
SELECT
	FIRST_NAME || ' ' || LAST_NAME,
	P.NAME
FROM BIODATA B
LEFT JOIN EMPLOYEE E ON B.ID = E.BIODATA_ID
LEFT JOIN EMPLOYEE_POSITION EP ON E.ID = EP.EMPLOYEE_ID
LEFT JOIN POSITION P ON P.ID = EP.POSITION_ID
WHERE NAME IS NULL

--SOAL 3
SELECT 
	FIRST_NAME || ' ' || LAST_NAME AS FULLNAME,
	CASE
		WHEN MARITAL_STATUS IS TRUE THEN 'SUDAH MENIKAH'
		WHEN MARITAL_STATUS IS FALSE THEN 'BELUM MENIKAH' 
	END AS STATUS_NIKAH,
	COUNT(DISTINCT F.STATUS) AS JUMLAH_ANAK
FROM BIODATA B
LEFT JOIN FAMILY F ON B.ID = F.BIODATA_ID
GROUP BY FULLNAME, STATUS_NIKAH

--SOAL 4
SELECT*
FROM DEPARTMENT

--SOAL 5
SELECT 
	DATE_PART('YEAR',TO_DATE(DOB,'YYYY-MM-DD')) AS TAHUN,
	COUNT(DOB) AS JUMLAH_KARYAWAN
FROM BIODATA B
LEFT JOIN EMPLOYEE E ON B.ID = E.BIODATA_ID
LEFT JOIN EMPLOYEE_POSITION EP ON E.ID = EP.EMPLOYEE_ID
LEFT JOIN POSITION P ON P.ID = EP.POSITION_ID
WHERE NAME IS NOT NULL
GROUP BY TAHUN

--SOAL 6
SELECT 
	B.*,
	P.NAME AS JABATAN
FROM BIODATA B
LEFT JOIN EMPLOYEE E ON B.ID = E.BIODATA_ID
LEFT JOIN EMPLOYEE_POSITION EP ON E.ID = EP.EMPLOYEE_ID
LEFT JOIN POSITION P ON P.ID = EP.POSITION_ID
		  
--SOAL 7
SELECT 
B.*
FROM BIODATA B
WHERE POB ILIKE 'JAKARTA' AND ADDRESS NOT ILIKE '%JAKARTA'

--SOAL 8
SELECT 
	FIRST_NAME || ' ' || LAST_NAME AS FULLNAME,
	P.NAME AS JABATAN,
	AGE(NOW(),TO_DATE(DOB,'YYYY-MM-DD')) AS USIA,
	COUNT(DISTINCT F.STATUS) AS JUMLAH_ANAK
FROM BIODATA B
LEFT JOIN EMPLOYEE E ON B.ID = E.BIODATA_ID
LEFT JOIN EMPLOYEE_POSITION EP ON E.ID = EP.EMPLOYEE_ID
LEFT JOIN POSITION P ON P.ID = EP.POSITION_ID
LEFT JOIN FAMILY F ON B.ID = F.BIODATA_ID
WHERE P.NAME IS NOT NULL
GROUP BY FULLNAME,JABATAN,USIA

--SOAL 9
SELECT 
	FIRST_NAME || ' ' || LAST_NAME AS FULLNAME,
	SUM(AGE(END_DATE, START_DATE)) AS LAMA_CUTI
FROM BIODATA B
LEFT JOIN EMPLOYEE E ON B.ID = E.BIODATA_ID
LEFT JOIN EMPLOYEE_POSITION EP ON E.ID = EP.EMPLOYEE_ID
LEFT JOIN POSITION P ON P.ID = EP.POSITION_ID
RIGHT JOIN LEAVE_REQUEST LR ON E.ID = LR.EMPLOYEE_ID
WHERE P.NAME IS NOT NULL
GROUP BY FULLNAME

--SOAL 10
SELECT 
	FIRST_NAME || ' ' || LAST_NAME AS FULLNAME,
	TT.NAME AS JENIS_PERJALANAN,
	TR.START_DATE||' S.D '||TR.END_DATE AS TANGGAL_PERJALANAN,
	SUM(TS.ITEM_COST) + TT.TRAVEL_FEE AS PENGELUARAN
FROM BIODATA B
JOIN EMPLOYEE E ON B.ID = E.BIODATA_ID
JOIN TRAVEL_REQUEST TR ON E.ID = TR.EMPLOYEE_ID
JOIN TRAVEL_TYPE TT ON TR.TRAVEL_TYPE_ID = TT.ID
JOIN TRAVEL_SETTLEMENT TS ON TS.TRAVEL_REQUEST_ID = TR.ID
GROUP BY FULLNAME,JENIS_PERJALANAN,TANGGAL_PERJALANAN,TT.TRAVEL_FEE
	




