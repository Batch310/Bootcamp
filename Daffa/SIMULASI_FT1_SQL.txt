--SIMULASI FT1
 --01

SELECT STATUS AS STATUS_KEPEGAWAIAN,
	COUNT(STATUS) AS JML_PEGAWAI
FROM EMPLOYEE
JOIN BIODATA ON EMPLOYEE.BIODATA_ID = BIODATA.ID
GROUP BY STATUS;

--02

SELECT CONCAT(FIRST_NAME,

								' ',
								LAST_NAME) AS FULLNAME,
	DOB AS TGL_LAHIR,
	POB TEMPAT_LAHIR,
	ADDRESS AS ALAMAT,
	MARITAL_STATUS AS STATUS_MENIKAH
FROM BIODATA
LEFT JOIN EMPLOYEE ON BIODATA.ID = EMPLOYEE.BIODATA_ID
WHERE EMPLOYEE.BIODATA_ID IS NULL;

--03

SELECT CONCAT(FIRST_NAME,

								' ',
								LAST_NAME) AS FULLNAME,
	CASE
					WHEN TRUE THEN 'MENIKAH'
					WHEN FALSE THEN 'BELUM MENIKAH'
	END AS STATUS_PERNIKAHAN,
	SUM(CASE
									WHEN F.STATUS ILIKE 'ANAK' THEN 1
					END) AS JML_ANAK
FROM BIODATA B
JOIN EMPLOYEE E ON B.ID = E.BIODATA_ID
JOIN FAMILY F ON B.ID = F.BIODATA_ID
WHERE F.STATUS ILIKE 'ANAK'
GROUP BY FULLNAME,
	STATUS_PERNIKAHAN;

--04

SELECT *
FROM DEPARTMENT --05

SELECT DATE_PART('YEAR',

								TO_DATE(DOB,

									'YYYY-MM-DD')) AS TAHUN_LAHIR,
	COUNT(DATE_PART('YEAR',

								TO_DATE(DOB,

									'YYYY-MM-DD'))) AS JML_KARYAWAN
FROM BIODATA B
JOIN EMPLOYEE E ON B.ID = E.BIODATA_ID
GROUP BY TAHUN_LAHIR;

--06

SELECT CONCAT(FIRST_NAME,

								' ',
								LAST_NAME) AS FULLNAME,
	DOB AS TGL_LAHIR,
	POB AS TEMPAT_LAHIR,
	ADDRESS AS ALAMAT,
	MARITAL_STATUS AS STATUS_MENIKAH,
	P.NAME AS JABATAN
FROM BIODATA B
JOIN EMPLOYEE E ON B.ID = E.BIODATA_ID
JOIN EMPLOYEE_POSITION EP ON E.ID = EP.EMPLOYEE_ID
JOIN POSITION P ON P.ID = EP.POSITION_ID;

--07

SELECT *
FROM BIODATA
WHERE POB ILIKE 'JAKARTA'
	AND ADDRESS NOT ILIKE '%JAKARTA%';

--08

SELECT CONCAT(FIRST_NAME,

								' ',
								LAST_NAME) AS FULLNAME,
	P.NAME,
	DATE_PART('YEAR',

		AGE(NOW(),

			TO_DATE(DOB,

				'YYYY-MM-DD'))) AS USIA,
	SUM(CASE
									WHEN F.STATUS ILIKE 'ANAK' THEN 1
									ELSE 0
					END) AS JML_ANAK
FROM BIODATA B
JOIN EMPLOYEE E ON B.ID = E.BIODATA_ID
JOIN EMPLOYEE_POSITION EP ON E.ID = EP.EMPLOYEE_ID
JOIN POSITION P ON EP.POSITION_ID = P.ID
JOIN FAMILY F ON B.ID = F.BIODATA_ID
GROUP BY FULLNAME,
	P.NAME,
	USIA;

--09

SELECT CONCAT(FIRST_NAME,

								' ',
								LAST_NAME) AS FULLNAME,
	SUM(AGE(END_DATE,

						START_DATE)) AS JML_HARI_CUTI
FROM BIODATA B
JOIN EMPLOYEE E ON B.ID = E.BIODATA_ID
JOIN LEAVE_REQUEST LR ON E.ID = LR.EMPLOYEE_ID
GROUP BY FULLNAME;

--10

SELECT CONCAT(FIRST_NAME,

								' ',
								LAST_NAME) AS FULLNAME,
	TT.NAME AS JENIS_PERJALANAN,
	TR.START_DATE AS DARI_TANGGAL,
	TR.END_DATE AS SAMPAI_TANGGAL,
	SUM(TS.ITEM_COST) + TT.TRAVEL_FEE AS TOTAL_PENGELUARAN
FROM BIODATA B
JOIN EMPLOYEE E ON B.ID = E.BIODATA_ID
JOIN TRAVEL_REQUEST TR ON E.ID = TR.EMPLOYEE_ID
JOIN TRAVEL_SETTLEMENT TS ON TR.ID = TS.TRAVEL_REQUEST_ID
JOIN TRAVEL_TYPE TT ON TT.ID = TR.TRAVEL_TYPE_ID
GROUP BY FULLNAME,
	JENIS_PERJALANAN,
	DARI_TANGGAL,
	SAMPAI_TANGGAL,
	TRAVEL_FEE;